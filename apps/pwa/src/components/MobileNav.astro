---
import FeedbackForm from './FeedbackForm.astro';
import ProfileDropdown from './ProfileDropdown.astro';
---

<!-- Burger Menu Button -->
<button 
    id="mobile-nav-toggle"
    class="md:hidden p-2 rounded-md hover:bg-white/10 transition-colors relative z-[60]"
    aria-label="Toggle menu"
    type="button"
>
    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
    </svg>
</button>

<script is:inline>
    // Create and inject mobile nav elements directly into body when DOM is ready
    if (typeof window !== 'undefined') {
        document.addEventListener('DOMContentLoaded', () => {
            // Check if already injected (in case component is used multiple times)
            if (document.getElementById('mobile-nav-overlay')) {
                return;
            }

            // Create overlay
            const overlay = document.createElement('div');
            overlay.id = 'mobile-nav-overlay';
            overlay.className = 'fixed inset-0 bg-black/50 backdrop-blur-sm hidden transition-opacity duration-300 md:hidden';
            overlay.style.cssText = 'opacity: 0; z-index: 999998;';
            
            // Create panel
            const panel = document.createElement('div');
            panel.id = 'mobile-nav-panel';
            panel.className = 'fixed top-0 right-0 h-full w-80 max-w-[85vw] bg-white shadow-2xl transition-transform duration-300 ease-in-out md:hidden';
            panel.style.cssText = 'transform: translateX(100%); z-index: 999999;';
            
            panel.innerHTML = `
                <div class="flex flex-col h-full">
                    <div class="flex items-center justify-between p-6 border-b border-gray-200">
                        <div class="flex items-center gap-2">
                            <img src="/logo.svg" alt="cebby" class="h-8" />
                        </div>
                        <button 
                            id="mobile-nav-close"
                            type="button"
                            class="p-2 rounded-lg hover:bg-gray-100 transition-colors text-gray-600 hover:text-gray-900"
                            aria-label="Close menu"
                        >
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                            </svg>
                        </button>
                    </div>
                    <nav class="flex-1 overflow-y-auto px-4 py-6">
                        <div class="flex flex-col gap-1">
                            <a href="/" class="flex items-center gap-3 font-medium text-gray-700 hover:bg-gray-100 hover:text-gray-900 transition-colors py-3 px-4 rounded-lg">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" />
                                </svg>
                                Home
                            </a>
                            <a href="/calendar" class="flex items-center gap-3 font-medium text-gray-700 hover:bg-gray-100 hover:text-gray-900 transition-colors py-3 px-4 rounded-lg">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
                                </svg>
                                Calendar
                            </a>
                            <a href="/partners" class="flex items-center gap-3 font-medium text-gray-700 hover:bg-gray-100 hover:text-gray-900 transition-colors py-3 px-4 rounded-lg">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z" />
                                </svg>
                                Partners
                            </a>
                            <a href="https://getcebby.notion.site" target="_blank" class="flex items-center gap-3 font-medium text-gray-700 hover:bg-gray-100 hover:text-gray-900 transition-colors py-3 px-4 rounded-lg">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7" />
                                </svg>
                                Roadmap
                            </a>
                            <a href="/profile" class="flex items-center gap-3 font-medium text-gray-700 hover:bg-gray-100 hover:text-gray-900 transition-colors py-3 px-4 rounded-lg">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                                </svg>
                                Profile
                            </a>
                        </div>
                        
                        <div class="mt-6 pt-6 border-t border-gray-200">
                            <h3 class="text-xs font-semibold text-gray-500 uppercase tracking-wider px-4 mb-3">Follow Us</h3>
                            <div class="flex flex-col gap-1">
                                <a href="https://www.facebook.com/getcebby" target="_blank" rel="noopener noreferrer" class="flex items-center gap-3 font-medium text-gray-700 hover:bg-gray-100 hover:text-blue-600 transition-colors py-3 px-4 rounded-lg">
                                    <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                                        <path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"></path>
                                    </svg>
                                    Facebook
                                </a>
                                <a href="https://github.com/dorelljames/event-ni" target="_blank" rel="noopener noreferrer" class="flex items-center gap-3 font-medium text-gray-700 hover:bg-gray-100 hover:text-gray-900 transition-colors py-3 px-4 rounded-lg">
                                    <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                                        <path d="M12 0C5.37 0 0 5.37 0 12c0 5.3 3.438 9.8 8.205 11.385.6.11.82-.26.82-.577 0-.285-.01-1.04-.015-2.04-3.338.725-4.042-1.61-4.042-1.61-.546-1.385-1.333-1.755-1.333-1.755-1.09-.745.083-.73.083-.73 1.205.085 1.84 1.24 1.84 1.24 1.07 1.835 2.805 1.305 3.49.998.108-.775.42-1.305.763-1.605-2.665-.305-5.466-1.335-5.466-5.93 0-1.31.47-2.38 1.235-3.22-.125-.305-.535-1.53.115-3.18 0 0 1.005-.32 3.3 1.23.96-.265 1.98-.4 3-.405 1.02.005 2.04.14 3 .405 2.28-1.55 3.285-1.23 3.285-1.23.655 1.65.245 2.875.12 3.18.77.84 1.235 1.91 1.235 3.22 0 4.61-2.805 5.62-5.475 5.92.43.37.815 1.1.815 2.22 0 1.605-.015 2.895-.015 3.285 0 .32.215.695.825.575C20.565 21.795 24 17.295 24 12c0-6.63-5.37-12-12-12z"></path>
                                    </svg>
                                    GitHub
                                </a>
                            </div>
                        </div>
                    </nav>
                </div>
            `;
            
            // Append to body
            document.body.appendChild(overlay);
            document.body.appendChild(panel);
            
            // Get elements
            const toggleBtn = document.getElementById('mobile-nav-toggle');
            const closeBtn = document.getElementById('mobile-nav-close');
            
            // Define functions
            function openMenu() {
                overlay.classList.remove('hidden');
                overlay.offsetHeight; // Trigger reflow
                overlay.style.opacity = '1';
                panel.style.transform = 'translateX(0)';
                document.body.style.overflow = 'hidden';
            }
            
            function closeMenu() {
                overlay.style.opacity = '0';
                panel.style.transform = 'translateX(100%)';
                setTimeout(() => overlay.classList.add('hidden'), 300);
                document.body.style.overflow = '';
            }
            
            // Attach event listeners
            if (toggleBtn) toggleBtn.addEventListener('click', openMenu);
            if (closeBtn) closeBtn.addEventListener('click', closeMenu);
            overlay.addEventListener('click', closeMenu);
            
            // Close on navigation
            panel.querySelectorAll('a').forEach(link => {
                link.addEventListener('click', closeMenu);
            });
            
            // Close on escape
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape' && !overlay.classList.contains('hidden')) {
                    closeMenu();
                }
            });
        });
    }
</script>
